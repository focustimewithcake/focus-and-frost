<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Mind Map Generator - Đơn giản</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff6b6b;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .app-description {
            font-size: 1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
        }
        
        .control-panel {
            flex: 1;
            min-width: 300px;
            padding: 15px;
        }
        
        .preview-panel {
            flex: 2;
            min-width: 400px;
            padding: 15px;
            border-left: 1px solid #eee;
        }
        
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .section-title i {
            font-size: 1.5rem;
        }
        
        .upload-area {
            border: 2px dashed var(--secondary-color);
            border-radius: 8px;
            padding: 30px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background-color: rgba(107, 140, 188, 0.05);
            margin-bottom: 15px;
        }
        
        .upload-area:hover {
            background-color: rgba(107, 140, 188, 0.1);
        }
        
        .upload-area i {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        .upload-text {
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .btn {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-accent {
            background-color: var(--accent-color);
        }
        
        .btn-accent:hover {
            background-color: #ff5252;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .layout-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .layout-option {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .layout-option:hover {
            border-color: var(--primary-color);
        }
        
        .layout-option.active {
            border-color: var(--primary-color);
            background-color: rgba(74, 111, 165, 0.1);
        }
        
        .layout-option i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .layout-name {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .mindmap-preview {
            min-height: 500px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            background-color: #f9f9f9;
            position: relative;
            overflow: auto;
        }
        
        .mindmap-container {
            width: 100%;
            height: 100%;
            position: relative;
            min-height: 450px;
        }
        
        /* Kiểu cây (mặc định) */
        .tree-layout .node {
            position: absolute;
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 12px;
            min-width: 150px;
            max-width: 200px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 2;
        }
        
        .tree-layout .central-node {
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
        }
        
        .tree-layout .node-1 { top: 150px; left: 25%; }
        .tree-layout .node-2 { top: 150px; left: 75%; }
        .tree-layout .node-3 { top: 250px; left: 12.5%; }
        .tree-layout .node-4 { top: 250px; left: 37.5%; }
        .tree-layout .node-5 { top: 250px; left: 62.5%; }
        .tree-layout .node-6 { top: 250px; left: 87.5%; }
        
        /* Kiểu tỏa tròn */
        .radial-layout .node {
            position: absolute;
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 12px;
            min-width: 150px;
            max-width: 200px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 2;
        }
        
        .radial-layout .central-node {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--primary-color);
            color: white;
        }
        
        .radial-layout .node-1 { top: 30%; left: 30%; }
        .radial-layout .node-2 { top: 30%; left: 70%; }
        .radial-layout .node-3 { top: 50%; left: 15%; }
        .radial-layout .node-4 { top: 50%; left: 85%; }
        .radial-layout .node-5 { top: 70%; left: 30%; }
        .radial-layout .node-6 { top: 70%; left: 70%; }
        
        /* Kiểu tổ chức */
        .org-layout .node {
            position: absolute;
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 12px;
            min-width: 150px;
            max-width: 200px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 2;
        }
        
        .org-layout .central-node {
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
        }
        
        .org-layout .node-1 { top: 150px; left: 30%; }
        .org-layout .node-2 { top: 150px; left: 70%; }
        .org-layout .node-3 { top: 250px; left: 20%; }
        .org-layout .node-4 { top: 250px; left: 50%; }
        .org-layout .node-5 { top: 250px; left: 80%; }
        .org-layout .node-6 { top: 350px; left: 50%; }
        
        .node-title {
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 4px;
            font-size: 0.9rem;
        }
        
        .central-node .node-title {
            color: white;
            border-bottom-color: rgba(255, 255, 255, 0.3);
        }
        
        .node-content {
            font-size: 0.8rem;
            min-height: 40px;
        }
        
        .node-image {
            margin-top: 8px;
            max-width: 100%;
            border-radius: 5px;
            max-height: 80px;
            object-fit: cover;
        }
        
        .connection {
            position: absolute;
            background: #999;
            z-index: 1;
            transform-origin: 0 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .progress-bar {
            height: 4px;
            background-color: #eee;
            border-radius: 5px;
            margin-top: 12px;
            overflow: hidden;
            display: none;
        }
        
        .progress {
            height: 100%;
            background-color: var(--success-color);
            width: 0%;
            transition: width 0.3s;
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 150px;
            margin-top: 12px;
            border-radius: 8px;
            display: none;
        }
        
        .status-message {
            margin-top: 8px;
            padding: 8px;
            border-radius: 5px;
            display: none;
            font-size: 0.85rem;
        }
        
        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status-info {
            background-color: #cce5ff;
            color: #004085;
            border: 1px solid #b8daff;
        }
        
        footer {
            text-align: center;
            padding: 15px;
            color: #6c757d;
            background-color: #f8f9fa;
            border-top: 1px solid #eee;
            font-size: 0.8rem;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .preview-panel {
                border-left: none;
                border-top: 1px solid #eee;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .layout-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Mind Map Generator</h1>
            <p class="app-description">Tạo sơ đồ tư duy từ hình ảnh - Tự động tạo sơ đồ hình cây</p>
        </header>
        
        <div class="main-content">
            <div class="control-panel">
                <section class="upload-section">
                    <h2 class="section-title"><i class="fas fa-upload"></i> Tải ảnh lên</h2>
                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p class="upload-text">Chọn ảnh từ thiết bị của bạn</p>
                        <button class="btn" id="browseButton">
                            <i class="fas fa-folder-open"></i> Chọn ảnh
                        </button>
                        <input type="file" id="fileInput" accept="image/*" style="display: none;">
                    </div>
                    <img id="imagePreview" class="image-preview" alt="Xem trước ảnh">
                    <div class="progress-bar" id="progressBar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <div id="statusMessage" class="status-message"></div>
                </section>
                
                <section class="layout-section">
                    <h2 class="section-title"><i class="fas fa-project-diagram"></i> Kiểu sơ đồ</h2>
                    <p>Chọn kiểu hiển thị cho sơ đồ tư duy</p>
                    <div class="layout-options">
                        <div class="layout-option active" data-layout="tree">
                            <i class="fas fa-tree"></i>
                            <div class="layout-name">Hình cây</div>
                        </div>
                        <div class="layout-option" data-layout="radial">
                            <i class="fas fa-bullseye"></i>
                            <div class="layout-name">Tỏa tròn</div>
                        </div>
                        <div class="layout-option" data-layout="org">
                            <i class="fas fa-sitemap"></i>
                            <div class="layout-name">Tổ chức</div>
                        </div>
                        <div class="layout-option" data-layout="custom">
                            <i class="fas fa-shapes"></i>
                            <div class="layout-name">Tùy chỉnh</div>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="preview-panel">
                <section class="preview-section">
                    <h2 class="section-title"><i class="fas fa-eye"></i> Sơ đồ tư duy</h2>
                    <div class="mindmap-preview">
                        <div class="mindmap-container tree-layout" id="mindmapContainer">
                            <!-- Sơ đồ tư duy sẽ được hiển thị ở đây -->
                            <div class="node central-node">
                                <div class="node-title">Chủ đề chính</div>
                                <div class="node-content">Tải ảnh lên để bắt đầu</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn" id="addImageBtn">
                            <i class="fas fa-image"></i> Thêm ảnh vào ô
                        </button>
                        <button class="btn btn-success" id="saveBtn">
                            <i class="fas fa-save"></i> Lưu sơ đồ
                        </button>
                        <button class="btn btn-accent" id="downloadBtn">
                            <i class="fas fa-download"></i> Tải xuống
                        </button>
                    </div>
                </section>
            </div>
        </div>
        
        <footer>
            <p>© 2023 AI Mind Map Generator | Tạo sơ đồ từ ảnh - Đơn giản và dễ sử dụng</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('fileInput');
            const uploadArea = document.getElementById('uploadArea');
            const browseButton = document.getElementById('browseButton');
            const progressBar = document.getElementById('progressBar');
            const progress = document.getElementById('progress');
            const mindmapContainer = document.getElementById('mindmapContainer');
            const addImageBtn = document.getElementById('addImageBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const saveBtn = document.getElementById('saveBtn');
            const imagePreview = document.getElementById('imagePreview');
            const statusMessage = document.getElementById('statusMessage');
            const layoutOptions = document.querySelectorAll('.layout-option');
            
            let selectedNode = null;
            let currentLayout = 'tree';
            
            // Xử lý sự kiện tải lên ảnh
            browseButton.addEventListener('click', function() {
                fileInput.click();
            });
            
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', handleImageUpload);
            
            // Xử lý tải lên ảnh và hiển thị xem trước
            function handleImageUpload() {
                if (!fileInput.files.length) return;
                
                const file = fileInput.files[0];
                
                // Kiểm tra xem có phải là file ảnh không
                if (!file.type.match('image.*')) {
                    showStatus('Vui lòng chọn file ảnh!', 'error');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    // Hiển thị ảnh xem trước
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    
                    // Xử lý ảnh và tạo sơ đồ tư duy
                    processImage(file);
                };
                
                reader.readAsDataURL(file);
            }
            
            // Xử lý ảnh và tạo sơ đồ
            function processImage(file) {
                progressBar.style.display = 'block';
                progress.style.width = '30%';
                
                showStatus('Đang xử lý ảnh...', 'info');
                
                // Giả lập quá trình xử lý AI và OCR
                setTimeout(function() {
                    progress.style.width = '60%';
                    
                    setTimeout(function() {
                        progress.style.width = '100%';
                        
                        // Giả lập kết quả trích xuất văn bản từ ảnh
                        const extractedText = "Đây là văn bản mẫu được trích xuất từ hình ảnh. Ứng dụng thực tế sẽ sử dụng API OCR như Tesseract.js để nhận dạng văn bản thật. Bạn có thể thay đổi kiểu sơ đồ bằng cách chọn các tùy chọn bên trái.";
                        
                        // Tạo sơ đồ tư duy từ văn bản (mặc định là hình cây)
                        createMindMap(extractedText);
                        
                        // Ẩn thanh tiến trình sau khi hoàn thành
                        setTimeout(function() {
                            progressBar.style.display = 'none';
                        }, 500);
                    }, 800);
                }, 500);
            }
            
            // Hiển thị thông báo trạng thái
            function showStatus(message, type) {
                statusMessage.textContent = message;
                statusMessage.className = 'status-message';
                statusMessage.classList.add(`status-${type}`);
                statusMessage.style.display = 'block';
                
                // Tự động ẩn thông báo sau 5 giây
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 5000);
            }
            
            // Tạo sơ đồ tư duy từ văn bản
            function createMindMap(text) {
                // Xóa nội dung cũ
                mindmapContainer.innerHTML = '';
                
                // Tách văn bản thành các dòng
                const lines = text.split('.').filter(line => line.trim().length > 0);
                
                // Tạo nút trung tâm
                const centralNode = createNode('Chủ đề chính', lines.length > 0 ? lines[0] : 'Nội dung chính', true);
                centralNode.classList.add('central-node');
                
                mindmapContainer.appendChild(centralNode);
                
                // Tạo các nút con từ các dòng còn lại
                if (lines.length > 1) {
                    for (let i = 1; i < Math.min(lines.length, 7); i++) {
                        const node = createNode(`Ý tưởng ${i}`, lines[i]);
                        node.classList.add(`node-${i}`);
                        mindmapContainer.appendChild(node);
                    }
                } else {
                    // Tạo các nút mẫu nếu không đủ nội dung
                    createSampleNodes();
                }
                
                // Áp dụng layout mặc định (hình cây)
                applyLayout(currentLayout);
            }
            
            // Tạo node mẫu
            function createSampleNodes() {
                const sampleContents = [
                    "Ý tưởng sáng tạo và đổi mới",
                    "Ghi chú quan trọng cần lưu ý",
                    "Kế hoạch hành động chi tiết",
                    "Mục tiêu phát triển dài hạn",
                    "Phân tích SWOT điểm mạnh - yếu",
                    "Đánh giá kết quả và hiệu suất"
                ];
                
                sampleContents.forEach((content, i) => {
                    const node = createNode(`Nhánh ${i+1}`, content);
                    node.classList.add(`node-${i+1}`);
                    mindmapContainer.appendChild(node);
                });
            }
            
            // Tạo một node mới
            function createNode(title, content, isCentral = false) {
                const node = document.createElement('div');
                node.className = 'node';
                
                node.innerHTML = `
                    <div class="node-title" contenteditable="true">${title}</div>
                    <div class="node-content" contenteditable="true">${content}</div>
                `;
                
                // Chọn node khi click
                node.addEventListener('click', (e) => {
                    // Bỏ chọn node cũ
                    if (selectedNode) {
                        selectedNode.style.boxShadow = '0 2px 5px rgba(0, 0, 0, 0.1)';
                    }
                    
                    // Chọn node mới
                    selectedNode = node;
                    node.style.boxShadow = '0 0 0 2px ' + (isCentral ? '#fff' : 'var(--primary-color)');
                    
                    // Di chuyển node lên trên cùng (z-index)
                    document.querySelectorAll('.node').forEach(n => {
                        n.style.zIndex = 2;
                    });
                    node.style.zIndex = 3;
                });
                
                return node;
            }
            
            // Áp dụng layout cho sơ đồ
            function applyLayout(layoutType) {
                // Xóa tất cả các lớp layout cũ
                mindmapContainer.classList.remove('tree-layout', 'radial-layout', 'org-layout', 'custom-layout');
                
                // Thêm lớp layout mới
                mindmapContainer.classList.add(layoutType + '-layout');
                
                // Cập nhật layout hiện tại
                currentLayout = layoutType;
            }
            
            // Xử lý sự kiện thêm ảnh vào ô
            addImageBtn.addEventListener('click', function() {
                if (!selectedNode) {
                    showStatus('Vui lòng chọn một ô để thêm ảnh', 'error');
                    return;
                }
                
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    // Kiểm tra xem có phải là file ảnh không
                    if (!file.type.match('image.*')) {
                        showStatus('Vui lòng chọn file ảnh!', 'error');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        // Kiểm tra xem đã có ảnh trong node chưa
                        const existingImage = selectedNode.querySelector('.node-image');
                        if (existingImage) {
                            existingImage.src = event.target.result;
                        } else {
                            const img = document.createElement('img');
                            img.src = event.target.result;
                            img.className = 'node-image';
                            selectedNode.querySelector('.node-content').appendChild(img);
                        }
                        
                        showStatus('Đã thêm ảnh vào ô', 'success');
                    };
                    
                    reader.readAsDataURL(file);
                };
                
                input.click();
            });
            
            // Xử lý sự kiện tải xuống
            downloadBtn.addEventListener('click', function() {
                showStatus('Tính năng tải xuống đang được phát triển', 'info');
            });
            
            // Xử lý sự kiện lưu sơ đồ
            saveBtn.addEventListener('click', function() {
                showStatus('Sơ đồ đã được lưu thành công', 'success');
            });
            
            // Xử lý thay đổi kiểu layout
            layoutOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Xóa active class từ tất cả options
                    layoutOptions.forEach(opt => opt.classList.remove('active'));
                    
                    // Thêm active class cho option được chọn
                    this.classList.add('active');
                    
                    // Áp dụng layout mới
                    const layoutType = this.getAttribute('data-layout');
                    applyLayout(layoutType);
                    
                    showStatus(`Đã chuyển sang kiểu sơ đồ: ${this.querySelector('.layout-name').textContent}`, 'success');
                });
            });
        });
    </script>
</body>
</html>
